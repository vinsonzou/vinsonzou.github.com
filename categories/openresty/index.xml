<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>OpenResty - 分类 - cloudSky's 小站</title><link>https://ops.m114.org/categories/openresty/</link><description>OpenResty - 分类 - cloudSky's 小站</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Fri, 12 May 2023 12:43:03 +0800</lastBuildDate><atom:link href="https://ops.m114.org/categories/openresty/" rel="self" type="application/rss+xml"/><item><title>Lua实现返回内容gzip解压/压缩</title><link>https://ops.m114.org/post/lua-gzip/</link><pubDate>Fri, 12 May 2023 12:43:03 +0800</pubDate><author><name>CloudSky</name></author><guid>https://ops.m114.org/post/lua-gzip/</guid><description>背景 最近要获取 jira 返回数据更新关注列表，jira 服务器的请求和返回的数据默认进行了 gzip 压缩。目前有 2 种方式 jira 设置中关闭 gzip 压缩 使用 lua 对 gzip 进行解压，</description></item><item><title>Lua小数四舍五入</title><link>https://ops.m114.org/post/lua-math/</link><pubDate>Fri, 25 Mar 2022 10:40:03 +0800</pubDate><author><name>CloudSky</name></author><guid>https://ops.m114.org/post/lua-math/</guid><description>保留整数 math.floor(x + 0.5) // 4.4 --&amp;gt; 4 math.floor(x) // 会直接舍弃小数点后的部分 保留几位小数进行四舍五入 公式为: math.floor(x * num + 0.5) / num 保留2位 num为100，3位为1000，… 比</description></item><item><title>lua-resty-openssl module not found</title><link>https://ops.m114.org/post/lua-resty-openssl-module-not-found/</link><pubDate>Tue, 07 Dec 2021 20:08:13 +0800</pubDate><author><name>CloudSky</name></author><guid>https://ops.m114.org/post/lua-resty-openssl-module-not-found/</guid><description><![CDATA[环境 OS: CentOS 8.4 OpenResty: 1.19.9.1(手动编译) OpenResty prefix: /app/nginx lua_package_path &quot;$prefix/lualib/?.lua;;&quot;; 报错如下 2021/12/07 18:56:11 [error] 2383822#0: *1 lua entry thread aborted: runtime error: /app/nginx//lualib/resty/openssl/pkey.lua:13: module &#39;resty.openssl.include.x509&#39; not found: no field package.preload[&#39;resty.openssl.include.x509&#39;] no file &#39;/app/nginx//lualib/resty/openssl/include/x509.lua&#39; no file &#39;./resty/openssl/include/x509.lua&#39; no file &#39;/app/nginx/luajit/share/luajit-2.1.0-beta3/resty/openssl/include/x509.lua&#39; no file &#39;/usr/local/share/lua/5.1/resty/openssl/include/x509.lua&#39; no file &#39;/usr/local/share/lua/5.1/resty/openssl/include/x509/init.lua&#39; no file &#39;/app/nginx/luajit/share/lua/5.1/resty/openssl/include/x509.lua&#39; no file &#39;/app/nginx/luajit/share/lua/5.1/resty/openssl/include/x509/init.lua&#39; 其]]></description></item><item><title>使用OpenResty reload ipsec服务</title><link>https://ops.m114.org/post/openresty-privileged-agent/</link><pubDate>Fri, 08 Oct 2021 11:13:08 +0800</pubDate><author><name>CloudSky</name></author><guid>https://ops.m114.org/post/openresty-privileged-agent/</guid><description>背景介绍 Debian 11 OpenResty 1.19.9.1 默认情况下，Nginx/OpenResty会启动一个root权限运行的master进程，之后再用指定的普通用户权限启动对应的</description></item><item><title>使用OpenResty mTLS认证</title><link>https://ops.m114.org/post/openresty-mtls/</link><pubDate>Wed, 29 Sep 2021 13:08:08 +0800</pubDate><author><name>CloudSky</name></author><guid>https://ops.m114.org/post/openresty-mtls/</guid><description>环境 CentOS 7 OpenResty 1.19.9.1 cosocket-mtls patch ngx_lua-0.10.20_01-cosocket-mtls.patch lua-resty-core-0.1.22_01-cosocket-mtls.patch lua-resty-http 为了支持mTLS功能，折腾的够呛，OpenResty官方又没支持，基于OpenResty的APISIX和Kong都有补</description></item><item><title>使用OpenResty实现简易CC防护</title><link>https://ops.m114.org/post/openresty-anticc/</link><pubDate>Sat, 11 Sep 2021 11:08:08 +0800</pubDate><author><name>CloudSky</name></author><guid>https://ops.m114.org/post/openresty-anticc/</guid><description>环境 CentOS 7 OpenResty 1.19.9.1 lua-resty-ipmatcher lua-var-nginx-module 功能 支持IP白名单 支持IP黑名单 计数key为：ip + &amp;ldquo;.&amp;rdquo; + md5(host + request_uri + useragent)，可自定义 60秒内请求超过60次就封禁3</description></item><item><title>使用Nginx实现授权下载</title><link>https://ops.m114.org/post/nginx-authorized-download/</link><pubDate>Fri, 11 Jun 2021 11:18:08 +0800</pubDate><author><name>CloudSky</name></author><guid>https://ops.m114.org/post/nginx-authorized-download/</guid><description>使用Nginx实现授权下载有两种方式，一种是nginx自带 --with-http_secure_link_module，另外一种是lua自定</description></item><item><title>lua实现微信机器人</title><link>https://ops.m114.org/post/nginx-wechat-ops/</link><pubDate>Fri, 11 Jun 2021 10:08:08 +0800</pubDate><author><name>CloudSky</name></author><guid>https://ops.m114.org/post/nginx-wechat-ops/</guid><description>使用企业微信调整值班人员信息，示例为联系人tag调整，可以自定义任何想实现功能。 环境 CentOS 7 Nginx lua-nginx-module lua-resty-http lua实现微信加密库 xml2lua ≤ v1.4-5 依赖服务 企业微信 配置</description></item><item><title>lua发布消息至RocketMQ解耦</title><link>https://ops.m114.org/post/nginx-use-mq/</link><pubDate>Thu, 03 Jun 2021 15:08:08 +0800</pubDate><author><name>CloudSky</name></author><guid>https://ops.m114.org/post/nginx-use-mq/</guid><description>广告点击回传数据入消息队列，避免后端处理不过来，先存入消息队列削峰。 环境 CentOS 7 Nginx lua-nginx-module lua-resty-core lua-resty-http 依赖服务 阿里云RocketMQ 配置 对应nginx loca</description></item><item><title>使用动态 DNS 来完成 HTTP 请求</title><link>https://ops.m114.org/post/dynamic-http-proxy/</link><pubDate>Thu, 03 Jun 2021 14:38:08 +0800</pubDate><author><name>CloudSky</name></author><guid>https://ops.m114.org/post/dynamic-http-proxy/</guid><description>内部访问外部http请求，通过拦截内部请求至此统一访问外部业务。 环境 CentOS 7 Nginx lua-nginx-module lua-resty-dns lua-resty-lock lua-resty-http 配置 对应nginx配置 lua_shared_dict dns_cache 5m; lua_shared_dict my_locks 1m; server { listen 80; server_name *.test.com; access_log logs/dyn_http.access.log default; location / {</description></item></channel></rss>