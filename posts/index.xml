<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on cloudSky's 小站</title><link>https://ops.m114.org/posts/</link><description>Recent content in Posts on cloudSky's 小站</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Tue, 07 Dec 2021 20:08:13 +0800</lastBuildDate><atom:link href="https://ops.m114.org/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>lua-resty-openssl module not found</title><link>https://ops.m114.org/post/lua-resty-openssl-module-not-found/</link><pubDate>Tue, 07 Dec 2021 20:08:13 +0800</pubDate><guid>https://ops.m114.org/post/lua-resty-openssl-module-not-found/</guid><description>环境 OS: CentOS 8.4 OpenResty: 1.19.9.1(手动编译) OpenResty prefix: /app/nginx lua_package_path &amp;quot;$prefix/lualib/?.lua;;&amp;quot;; 报错如下 2021/12/07 18:56:11 [error] 2383822#0: *1 lua entry thread aborted: runtime error: /app/nginx//lualib/resty/openssl/pkey.lua:13: module 'resty.openssl.include.x509' not found: no field package.preload['resty.openssl.include.x509'] no file '/app/nginx//lualib/resty/openssl/include/x509.lua' no file './resty/openssl/include/x509.lua' no file '/app/nginx/luajit/share/luajit-2.1.0-beta3/resty/openssl/include/x509.lua' no file '/usr/local/share/lua/5.1/resty/openssl/include/x509.lua' no file '/usr/local/share/lua/5.1/resty/openssl/include/x509/init.lua' no file '/app/nginx/luajit/share/lua/5.1/resty/openssl/include/x509.lua' no file '/app/nginx/luajit/share/lua/5.1/resty/openssl/include/x509/init.lua' 其</description></item><item><title>Alibaba Cloud Linux 3编译wireguard模块</title><link>https://ops.m114.org/post/aliyun-linux-3-build-wireguard-module/</link><pubDate>Fri, 22 Oct 2021 16:01:09 +0800</pubDate><guid>https://ops.m114.org/post/aliyun-linux-3-build-wireguard-module/</guid><description>因wireguard已经合并至5.6内核中，刚好Alibaba Cloud Linux 3是5.10内核，结果测试下来没有wireguard模块， 因是CentOS</description></item><item><title>Golang中uint、int, int8, int16, int32, int64区别</title><link>https://ops.m114.org/post/go-int-vs-uint/</link><pubDate>Wed, 20 Oct 2021 16:47:09 +0800</pubDate><guid>https://ops.m114.org/post/go-int-vs-uint/</guid><description>Golang各种数值占据的大小 int 类型大小为 8 字节 int8 类型大小为 1 字节 int16 类型大小为 2 字节 int32 类型大小为 4 字节 int64 类型大小为 8 字节 go语言中的int的</description></item><item><title>Hugo使用Github Action自动部署到Github Pages</title><link>https://ops.m114.org/post/deploy-to-ghpages-with-github-action/</link><pubDate>Thu, 14 Oct 2021 16:35:08 +0800</pubDate><guid>https://ops.m114.org/post/deploy-to-ghpages-with-github-action/</guid><description>目的 hugo手动部署到github pages流程: 使用hugo生成静态网页 将静态网页push到建好的github pages repo中，一般是&amp;lt;</description></item><item><title>使用OpenResty reload ipsec服务</title><link>https://ops.m114.org/post/openresty-privileged-agent/</link><pubDate>Fri, 08 Oct 2021 11:13:08 +0800</pubDate><guid>https://ops.m114.org/post/openresty-privileged-agent/</guid><description>背景介绍 Debian 11 OpenResty 1.19.9.1 默认情况下，Nginx/OpenResty会启动一个root权限运行的master进程，之后再用指定的普通用户权限启动对应的</description></item><item><title>使用OpenResty mTLS认证</title><link>https://ops.m114.org/post/openresty-mtls/</link><pubDate>Wed, 29 Sep 2021 13:08:08 +0800</pubDate><guid>https://ops.m114.org/post/openresty-mtls/</guid><description>环境 CentOS 7 OpenResty 1.19.9.1 cosocket-mtls patch ngx_lua-0.10.20_01-cosocket-mtls.patch lua-resty-core-0.1.22_01-cosocket-mtls.patch lua-resty-http 为了支持mTLS功能，折腾的够呛，OpenResty官方又没支持，基于OpenResty的APISIX和Kong都有补</description></item><item><title>CFSSL使用</title><link>https://ops.m114.org/post/cfssl/</link><pubDate>Tue, 28 Sep 2021 09:08:08 +0800</pubDate><guid>https://ops.m114.org/post/cfssl/</guid><description>简介 在工作中，我们经常会遇到各种证书问题，如k8s,etcd等服务时，我们往往都要使用证书，本文将使用CFSSL工具快速简单的配置证书。这里</description></item><item><title>使用OpenResty实现简易CC防护</title><link>https://ops.m114.org/post/openresty-anticc/</link><pubDate>Sat, 11 Sep 2021 11:08:08 +0800</pubDate><guid>https://ops.m114.org/post/openresty-anticc/</guid><description>环境 CentOS 7 OpenResty 1.19.9.1 lua-resty-ipmatcher lua-var-nginx-module 功能 支持IP白名单 支持IP黑名单 计数key为：ip + &amp;ldquo;.&amp;rdquo; + md5(host + request_uri + useragent)，可自定义 60秒内请求超过60次就封禁3</description></item><item><title>防止SNI信息泄露</title><link>https://ops.m114.org/post/use-ssl_reject_handshake/</link><pubDate>Sun, 04 Jul 2021 10:08:08 +0800</pubDate><guid>https://ops.m114.org/post/use-ssl_reject_handshake/</guid><description>有了 ssl_reject_handshake (Nginx ≥ 1.19.4)这个参数，再也不需要strict-sni.patch了。 本质需求就是为了当机器人或者奇怪的人类通过HTTPS访问你的</description></item><item><title>巧用 cache-control: s-maxage 优化CDN和浏览器缓存同步</title><link>https://ops.m114.org/post/use-s-maxage-for-cdn/</link><pubDate>Mon, 14 Jun 2021 11:18:08 +0800</pubDate><guid>https://ops.m114.org/post/use-s-maxage-for-cdn/</guid><description>在实际使用中会发现，通常源站资源发生变化后，我们会尝试刷新CDN。但是由于用户浏览器依旧保留旧资源，造成访问不一致的问题。解决思路如下: 在源</description></item><item><title>使用Nginx实现授权下载</title><link>https://ops.m114.org/post/nginx-authorized-download/</link><pubDate>Fri, 11 Jun 2021 11:18:08 +0800</pubDate><guid>https://ops.m114.org/post/nginx-authorized-download/</guid><description>使用Nginx实现授权下载有两种方式，一种是nginx自带 --with-http_secure_link_module，另外一种是lua自定</description></item><item><title>lua实现微信机器人</title><link>https://ops.m114.org/post/nginx-wechat-ops/</link><pubDate>Fri, 11 Jun 2021 10:08:08 +0800</pubDate><guid>https://ops.m114.org/post/nginx-wechat-ops/</guid><description>使用企业微信调整值班人员信息，示例为联系人tag调整，可以自定义任何想实现功能。 环境 CentOS 7 Nginx lua-nginx-module lua-resty-http lua实现微信加密库 xml2lua ≤ v1.4-5 依赖服务 企业微信 配置</description></item><item><title>MySQL插件之审计</title><link>https://ops.m114.org/post/mysql-plugin-audit/</link><pubDate>Tue, 08 Jun 2021 14:10:08 +0800</pubDate><guid>https://ops.m114.org/post/mysql-plugin-audit/</guid><description>目录 等保需求 背景 插件安装 插件配置 等保需求 审计功能：记录时间、来源IP、用户、行为、数据库、SQL。 背景 Oracle 的 MySQL 社区版不带审计插件（Audit P</description></item><item><title>MySQL插件之密码复杂性</title><link>https://ops.m114.org/post/mysql-plugin-validate-password/</link><pubDate>Tue, 08 Jun 2021 13:30:08 +0800</pubDate><guid>https://ops.m114.org/post/mysql-plugin-validate-password/</guid><description>目录 等保需求 插件介绍 插件安装 插件配置 等保需求 用户密码复杂度：3种字符以上，至少8位长度。使用 validate_password 插件实现。 插件介绍 MySQL 5.6/5.7 上密码复杂度策略实现, MySQL</description></item><item><title>MySQL插件之Connection-Control</title><link>https://ops.m114.org/post/mysql-plugin-connection-control/</link><pubDate>Tue, 08 Jun 2021 13:10:08 +0800</pubDate><guid>https://ops.m114.org/post/mysql-plugin-connection-control/</guid><description>目录 等保需求 插件介绍 插件安装 插件配置 等保需求 登录失败策略：登录失败5次锁定10分钟，使用 Connection-Control 插件实现。 插件介绍 MySQL 5.7.17 以后提供了 Connection-Control 插件用来控制客户</description></item><item><title>sysbench试用</title><link>https://ops.m114.org/post/sysbench-trial/</link><pubDate>Tue, 08 Jun 2021 10:10:08 +0800</pubDate><guid>https://ops.m114.org/post/sysbench-trial/</guid><description>目录 背景 环境 安装 测试 背景 主要测试开启审计插件OLTP性能损失多大，安装和测试方法如下 环境 CentOS 7.4 MySQL: 5.7.23 innodb_buffer_pool_size: 8G innodb_buffer_pool_instances: 8【默认】 innodb_buffer_pool_chunk_size: 134217728【即12</description></item><item><title>python 3.9.5 编译报错 Could not import runpy module 问题</title><link>https://ops.m114.org/post/python-3.9.5-build-error/</link><pubDate>Sat, 05 Jun 2021 13:15:08 +0800</pubDate><guid>https://ops.m114.org/post/python-3.9.5-build-error/</guid><description>环境 CentOS 7.3.1611 gcc-4.8.5-28.el7_5.1 Python 3.9.5 相关报错 ./python -E -S -m sysconfig --generate-posix-vars ;\ if test $? -ne 0 ; then \ echo &amp;#34;generate-posix-vars failed&amp;#34; ; \ rm -f ./pybuilddir.txt ; \ exit 1 ; \ fi Could not import runpy module Traceback (most recent call last): File &amp;#34;/tmp/Python-3.9.5/Lib/runpy.py&amp;#34;, line 15, in &amp;lt;module&amp;gt; import importlib.util File &amp;#34;/tmp/Python-3.9.5/Lib/importlib/util.py&amp;#34;, line 2, in &amp;lt;module&amp;gt; from . import abc File</description></item><item><title>lua发布消息至RocketMQ解耦</title><link>https://ops.m114.org/post/nginx-use-mq/</link><pubDate>Thu, 03 Jun 2021 15:08:08 +0800</pubDate><guid>https://ops.m114.org/post/nginx-use-mq/</guid><description>广告点击回传数据入消息队列，避免后端处理不过来，先存入消息队列削峰。 环境 CentOS 7 Nginx lua-nginx-module lua-resty-core lua-resty-http 依赖服务 阿里云RocketMQ 配置 对应nginx loca</description></item><item><title>使用动态 DNS 来完成 HTTP 请求</title><link>https://ops.m114.org/post/dynamic-http-proxy/</link><pubDate>Thu, 03 Jun 2021 14:38:08 +0800</pubDate><guid>https://ops.m114.org/post/dynamic-http-proxy/</guid><description>内部访问外部http请求，通过拦截内部请求至此统一访问外部业务。 环境 CentOS 7 Nginx lua-nginx-module lua-resty-dns lua-resty-lock lua-resty-http 配置 对应nginx配置 lua_shared_dict dns_cache 5m; lua_shared_dict my_locks 1m; server { listen 80; server_name *.test.com; access_log logs/dyn_http.access.log default; location / {</description></item><item><title>Nginx实现ip查询服务</title><link>https://ops.m114.org/post/nginx-ipip-service/</link><pubDate>Thu, 03 Jun 2021 13:08:08 +0800</pubDate><guid>https://ops.m114.org/post/nginx-ipip-service/</guid><description>实现内部IP查询服务 查询当前公网IP 查询当前公网IP地理信息，支持IPv4/IPv6 查询指定IP的地理信息，支持IPv4/IPv6 环境 CentOS 7 Nginx</description></item><item><title>Gogs/Gitea webhook支持</title><link>https://ops.m114.org/post/gitea-webhook/</link><pubDate>Thu, 03 Jun 2021 10:08:08 +0800</pubDate><guid>https://ops.m114.org/post/gitea-webhook/</guid><description>实现需求为git提交后，自动同步至webhook所在机器的指定目录。也可以支持github的webhook，也能根据不同条件触发不同的web</description></item><item><title>使用Nginx做SNI反向代理</title><link>https://ops.m114.org/post/nginx-sniproxy/</link><pubDate>Wed, 02 Jun 2021 10:18:08 +0800</pubDate><guid>https://ops.m114.org/post/nginx-sniproxy/</guid><description>从 Nginx 1.11.5 版本开始支持用做 SNI 反代，使用 Nginx 做 SNI 反代比用 SNI Proxy 配置起来更简单、更稳定。Nginx stream流程处理见官方文档，此功能可用来加速国外h</description></item><item><title>Nginx支持WebP</title><link>https://ops.m114.org/post/nginx-support-webp/</link><pubDate>Wed, 02 Jun 2021 10:08:08 +0800</pubDate><guid>https://ops.m114.org/post/nginx-support-webp/</guid><description>WebP格式，Google开发的一种旨在加快图片加载速度的图片格式。图片压缩体积大约只有JPEG的2/3，并能节省大量的服务器带宽资源和数据</description></item><item><title>本人OpenResty实践集合</title><link>https://ops.m114.org/post/openresty-case/</link><pubDate>Tue, 01 Jun 2021 10:08:08 +0800</pubDate><guid>https://ops.m114.org/post/openresty-case/</guid><description>优化 支持Brotli Upstream主动健康检查 动态证书 OCSP缓存 ssl分布式session mTLS支持 命令行执行 Nginx支持WebP gogs/gitea</description></item><item><title>golang encrypt/decrypt by MacOS keychain</title><link>https://ops.m114.org/post/golang-aes-crypt/</link><pubDate>Tue, 18 May 2021 10:08:00 +0800</pubDate><guid>https://ops.m114.org/post/golang-aes-crypt/</guid><description>功能如下: AES加密/解密 AES秘钥从MacOS keychain读取 支持Data At Rest Encryption (DARE)，加密文件内存占用小于100K，参考 sio</description></item><item><title>4层TCP转发后获得真实IP之proxy_protocol</title><link>https://ops.m114.org/post/tcp-proxy-get-source-ip-by-proxy_protocol/</link><pubDate>Mon, 19 Apr 2021 17:01:15 +0800</pubDate><guid>https://ops.m114.org/post/tcp-proxy-get-source-ip-by-proxy_protocol/</guid><description>需求 后端TCP Server在经过TCP代理(nginx stream模块)后，程序不做任何调整获得用户真实IP。 了解到cloudflare的s</description></item><item><title>CentOS8编译安装MySQL 5.7.30</title><link>https://ops.m114.org/post/centos8-build-mysql5.7.30/</link><pubDate>Thu, 18 Jun 2020 13:41:15 +0800</pubDate><guid>https://ops.m114.org/post/centos8-build-mysql5.7.30/</guid><description>环境 OS: CentOS 8.2 MySQL: 5.7.30 报错信息 1. 编译报错 CMake Error at plugin/group_replication/libmysqlgcs/rpcgen.cmake:100 (MESSAGE): Could not find rpcgen Call Stack (most recent call first): plugin/group_replication/libmysqlgcs/CMakeLists.txt:38 (INCLUDE) 解决方法 yum --enablerepo=PowerTools install rpcgen 2. systemctl start mysqld.service报错无法启动问题 报错信息</description></item><item><title>CentOS7上如何支持安装CentOS8 VM</title><link>https://ops.m114.org/post/centos8-install-on-centos7-kvm/</link><pubDate>Fri, 12 Jun 2020 13:12:06 +0800</pubDate><guid>https://ops.m114.org/post/centos8-install-on-centos7-kvm/</guid><description>环境 宿主机：CentOS 7.5 VM: CentOS 8.1 查看支持os osinfo-query os 当前环境默认不支持CentOS8/RHEL8，需做如下操作: # osinfo-db 需更新至osinfo-db-</description></item><item><title>GitHub supports WebAuthn</title><link>https://ops.m114.org/post/github-supports-webauthn-for-security-keys/</link><pubDate>Fri, 23 Aug 2019 15:05:22 +0800</pubDate><guid>https://ops.m114.org/post/github-supports-webauthn-for-security-keys/</guid><description>为了提高 GitHub 帐户的安全性，GitHub平台2019-08-21通过支持 Web 身份验证（WebAuthn）标准宣布了易于使用的身份验证选项。通过 We</description></item><item><title>Python的while 1跟while True到底有什么区别?</title><link>https://ops.m114.org/post/python-while-1-vs-for-whiletrue/</link><pubDate>Wed, 23 Jan 2019 17:46:06 +0800</pubDate><guid>https://ops.m114.org/post/python-while-1-vs-for-whiletrue/</guid><description>定义两个方法,分别使用while循环 def t1(): while 1: pass def t2(): while True: pass 单从功能上说,两种无任何区别,那么,来看看字节码上的区别: For Python 2.x import dis #载入反编译模块</description></item><item><title>libvirt 4.5 virModuleLoadFile:53</title><link>https://ops.m114.org/post/libvirt-4.5-virmoduleloadfile53/</link><pubDate>Tue, 15 Jan 2019 17:27:22 +0800</pubDate><guid>https://ops.m114.org/post/libvirt-4.5-virmoduleloadfile53/</guid><description>CentOS 7.5.1804的libvirt从3.9升级至4.5时，无法启动，报错如下： error : virModuleLoadFile:53 : internal error: Failed to load module &amp;lsquo;/usr/lib64/libvirt/storage-backend/libvirt_storage_backend_rbd.so&amp;rsquo;: /usr/lib64/libvirt/storage-backend/libvirt_storage_backend_rbd.so: undefined symbol: rbd_diff_iterate2 详细报错如下: [root@localhost ~]# libvirtd -v 2019-01-15 08:56:53.433+0000: 34181: info :</description></item><item><title>Python数据库连接池实例--PooledDB</title><link>https://ops.m114.org/post/python-mysql-pooleddb/</link><pubDate>Tue, 16 Oct 2018 16:27:12 +0800</pubDate><guid>https://ops.m114.org/post/python-mysql-pooleddb/</guid><description>不用连接池的MySQL连接方法 import MySQLdb conn= MySQLdb.connect(host=&amp;#39;127.0.0.1&amp;#39;,user=&amp;#39;root&amp;#39;,passwd=&amp;#39;password&amp;#39;,db=&amp;#39;DB_test&amp;#39;,port=3306) cur=conn.cursor() SQL=&amp;#34;select * from table_test&amp;#34; cur.execute(SQL) r=cur.fetchall() cur.close() conn.close() 用连接池后的连接方法 import MySQLdb from DBUtils.PooledDB import PooledDB pool = PooledDB(MySQLdb,5,host=&amp;#39;127.0.0.1&amp;#39;,user=&amp;#39;root&amp;#39;,passwd=&amp;#39;password&amp;#39;,db=&amp;#39;DB_test&amp;#39;,port=3306) #5为连接池里的最少连接数 conn = pool.connection() #以后每次需要</description></item><item><title>使用curl请求https时指定IP</title><link>https://ops.m114.org/post/request-https-server-in-custom-ip-with-curl/</link><pubDate>Wed, 06 Jun 2018 10:00:00 +0800</pubDate><guid>https://ops.m114.org/post/request-https-server-in-custom-ip-with-curl/</guid><description>一般使用curl请求自定义IP地址并且指定HOST的话可以这样。 curl -H &amp;#39;Host: ops.m114.org&amp;#39; http://127.0.0.1 但是如果你需要请求的地址是HTTPS就不行了 $ curl -H &amp;#39;Host: ops.m114.org&amp;#39; https://127.0.0.1/ curl: (51) Unable to communicate</description></item><item><title>go如何编译出更小的执行文件?</title><link>https://ops.m114.org/post/go-build-small-exec/</link><pubDate>Wed, 23 Aug 2017 23:38:09 +0800</pubDate><guid>https://ops.m114.org/post/go-build-small-exec/</guid><description>前言 本地默认编译出的文件总与官方提供的二进制文件大很多，Google之后得知通过编译参数控制还能编译出更小的可执行文件。 加-ldflags参</description></item><item><title>Golang之command line flag笔记</title><link>https://ops.m114.org/post/golang-command-line-flags/</link><pubDate>Wed, 16 Aug 2017 23:28:33 +0800</pubDate><guid>https://ops.m114.org/post/golang-command-line-flags/</guid><description>示例代码，仅供参考 package main import ( &amp;#34;fmt&amp;#34; &amp;#34;flag&amp;#34; ) func main() { // golang的flag包的一些基本使用方法 // 待使用的变量 var id int var name string var male bool // 是否已经解析 fmt.Println(&amp;#34;parsed? = &amp;#34;, flag.Parsed()) // 设</description></item><item><title>analysing java core dump</title><link>https://ops.m114.org/post/analysing-java-core-dump/</link><pubDate>Sun, 23 Jul 2017 16:32:26 +0800</pubDate><guid>https://ops.m114.org/post/analysing-java-core-dump/</guid><description>In this post, I will show you how you can debug a Java core file to see what caused your JVM to crash. I will be using a core file I generated in my previous post: Generating a Java Core Dump. There are different ways you can diagnose a JVM crash, listed below: The hs_err_pid log file When a fatal error occurs in the JVM, it produces an error log</description></item><item><title>Error: 500 OOPS: priv_sock_get_cmd [SOLVED]</title><link>https://ops.m114.org/post/error-500-oops-priv_sock_get_cmd-solved/</link><pubDate>Sun, 23 Jul 2017 16:21:45 +0800</pubDate><guid>https://ops.m114.org/post/error-500-oops-priv_sock_get_cmd-solved/</guid><description>Troubleshooting seccomp filter sanboxing with vsftpd 3.0.x
The following error may occur on ftp clients with vsftpd 3.0.x:
500 OOPS: priv_sock_get_cmd This is caused by seccomp filter sanboxing, which is enabled by default on amd64. To workaround this issue, disable seccomp filter sanboxing:
echo &amp;#39;seccomp_sandbox=NO&amp;#39; &amp;gt;&amp;gt; vsftpd.conf service vsftpd restart For further information, refer to Red Hat bug #845980.</description></item><item><title>Python版本号比较</title><link>https://ops.m114.org/post/python-version-cmp/</link><pubDate>Sun, 23 Jul 2017 16:13:10 +0800</pubDate><guid>https://ops.m114.org/post/python-version-cmp/</guid><description>第一种比较方法(StrictVersion) StrictVersion是由.将一串带有预发布标签的数字分隔为两个或三个部分的格式，预发布标签</description></item><item><title>golang sync.WaitGroup解决goroutine同步</title><link>https://ops.m114.org/post/sync-waitgroup/</link><pubDate>Mon, 03 Jul 2017 16:27:12 +0800</pubDate><guid>https://ops.m114.org/post/sync-waitgroup/</guid><description>**go提供了sync包和channel来解决协程同步和通讯。**新手对channel通道操作起来更容易产生死锁，如果时缓冲的channel</description></item><item><title>Tomcat 7.0.76 Invalid character found in the request target</title><link>https://ops.m114.org/post/fix-tomcat-upgrade-error/</link><pubDate>Mon, 27 Mar 2017 13:08:25 +0800</pubDate><guid>https://ops.m114.org/post/fix-tomcat-upgrade-error/</guid><description>故障现象 升级tomcat至7.0.76后，GET请求的参数中含有中文时tomcat返回400错误，tomcat错误日志如下 java.lang.IllegalArgumentException: Invalid character found in the request target. The</description></item><item><title>不重启解决Too Many Connections</title><link>https://ops.m114.org/post/solve-too-many-connections/</link><pubDate>Sat, 07 Jan 2017 19:57:32 +0800</pubDate><guid>https://ops.m114.org/post/solve-too-many-connections/</guid><description>当发生Too many connections时，即使是DBA也无法登录到数据库，一般的做法是修改配置文件的max_connections参数，然后重</description></item><item><title>在 OpenResty 中使用正则表达式</title><link>https://ops.m114.org/post/use-regular-expressions-in-openresty/</link><pubDate>Sun, 30 Oct 2016 10:48:19 +0800</pubDate><guid>https://ops.m114.org/post/use-regular-expressions-in-openresty/</guid><description>在 OpenResty 中使用正则表达式，社区中推荐的做法是使用ngx.re api。比如匹配一个字符串是否为 http(s) 的链接，可以这么写： local function is_http_url(s) return ngx.re.find(s, [[^https?://[\w-_?.:/+=&amp;amp;#%]+$]]) end 压测一下: local t =</description></item><item><title>[python]统计列表中重复项的出现次数</title><link>https://ops.m114.org/post/python-count-duplicate-values-of-list/</link><pubDate>Sun, 30 Oct 2016 10:27:24 +0800</pubDate><guid>https://ops.m114.org/post/python-count-duplicate-values-of-list/</guid><description>列表项由数字、字符串组成，统计重复项 &amp;gt;&amp;gt;&amp;gt; from collections import defaultdict &amp;gt;&amp;gt;&amp;gt; d = defaultdict(int) &amp;gt;&amp;gt;&amp;gt; for x in [1, 2, 3, 1, 2, 3, 1]: ... d[x] += 1 ... &amp;gt;&amp;gt;&amp;gt; dict(d) {1: 3, 2: 2, 3: 2} &amp;gt;&amp;gt;&amp;gt; &amp;gt;&amp;gt;&amp;gt; c = defaultdict(int) &amp;gt;&amp;gt;&amp;gt; for y in [&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;a&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;c&amp;#39;]: ... c[y] += 1 ...</description></item><item><title>Ceph核心概念备忘录</title><link>https://ops.m114.org/post/ceph-key-concepts-backup/</link><pubDate>Fri, 26 Aug 2016 14:38:12 +0800</pubDate><guid>https://ops.m114.org/post/ceph-key-concepts-backup/</guid><description>scrub ceph-osd会定义启动scrub线程，扫描部分对象（哪些对象？），和其他副本比较，发现是否一致。如果发现不一致，ceph会抛出这个异常</description></item><item><title>ceph pgs inconsistent</title><link>https://ops.m114.org/post/ceph-pgs-inconsistent/</link><pubDate>Wed, 17 Aug 2016 23:44:59 +0800</pubDate><guid>https://ops.m114.org/post/ceph-pgs-inconsistent/</guid><description>OSD扩容后出现如下错误 HEALTH_ERR 2 pgs inconsistent; 320 scrub errors [root@ceph01 ~]# ceph health detail HEALTH_ERR 2 pgs inconsistent; 320 scrub errors pg 10.9 is active+clean+inconsistent, acting [6,0,9] pg 10.10 is active+clean+scrubbing+deep+inconsistent, acting [2,6,4] 320 scrub errors 修复处于不一致状态的pgs [root@ceph01 ~]# ceph pg repair 10.9 instructing pg 10.9 on osd.6</description></item><item><title>删除osd的正确方式</title><link>https://ops.m114.org/post/right-steps-delete-ceph-osd/</link><pubDate>Sat, 06 Aug 2016 23:51:26 +0800</pubDate><guid>https://ops.m114.org/post/right-steps-delete-ceph-osd/</guid><description>按照官网的步骤走的话，在 标记osd为out 和 从crushmap删除osd 这两步都会触发数据再平衡，如下方式只触发了一次迁移，建议使用。 调整o</description></item><item><title>Centos 7.x systemd对比Centos 6.x daemon</title><link>https://ops.m114.org/post/centos7-systemd-vs-centos6-daemon/</link><pubDate>Sat, 06 Aug 2016 13:54:53 +0800</pubDate><guid>https://ops.m114.org/post/centos7-systemd-vs-centos6-daemon/</guid><description>从CentOS 7.x开始，CentOS开始使用systemd服务来代替daemon，原来管理系统启动和管理系统服务的相关命令全部由syste</description></item><item><title>MySQL Unable to lock ibdata1 error 11 fix</title><link>https://ops.m114.org/post/mysql-unable-to-lock-ibdata1-error-11-fix/</link><pubDate>Wed, 03 Aug 2016 10:52:24 +0800</pubDate><guid>https://ops.m114.org/post/mysql-unable-to-lock-ibdata1-error-11-fix/</guid><description>A bad shutdown can cause such erros on MySQL.
InnoDB: Unable to lock ./ibdata1, error: 11 InnoDB: Check that you do not already have another mysqld process InnoDB: using the same InnoDB data or log files. InnoDB: Error in opening ./ibdata1 For solution mv ibdata1 ibdata1.bak cp -a ibdata1.bak ibdata1 service mysqld restart</description></item><item><title>ceph集群jewel版本部署osd激活权限报错</title><link>https://ops.m114.org/post/ceph-jewel-osd-activate-bug/</link><pubDate>Fri, 29 Jul 2016 00:29:29 +0800</pubDate><guid>https://ops.m114.org/post/ceph-jewel-osd-activate-bug/</guid><description>环境 ceph version 10.2.2 (45107e21c568dd033c2f0a3107dec8f0b0e58374)ceph-deploy 1.5.34 ceph集群jewel版本部署过程中执行osd激活操作如下 ceph-deploy osd activate ceph13:/dev/sdb1:/dev/sda2 报错内容如下 [2016-07-29 00:05:19,106][ceph_deploy.conf][DEBUG ] found configuration file at: /root/.cephdeploy.conf [2016-07-29 00:05:19,107][ceph_deploy.cli][INFO ] Invoked (1.5.34): /bin/ceph-deploy osd activate ceph13:/dev/sdb1:/dev/sda2 [2016-07-29 00:05:19,107][ceph_deploy.cli][INFO ] ceph-deploy options: [2016-07-29 00:05:19,108][ceph_deploy.cli][INFO</description></item><item><title>使用国内源部署Ceph</title><link>https://ops.m114.org/post/deploy-ceph-using-china-mirror/</link><pubDate>Thu, 28 Jul 2016 13:17:52 +0800</pubDate><guid>https://ops.m114.org/post/deploy-ceph-using-china-mirror/</guid><description>由于网络方面的原因，Ceph的部署经常受到干扰，通常为了加速部署，基本上大家都是将Ceph的源同步到本地进行安装。根据Ceph中国社区的统计</description></item><item><title>R420服务器idrac连接用户数超限制</title><link>https://ops.m114.org/post/fix-dell-idrac-7-error-rac0218-the-maximum-number-of-user-sessions-is-reached/</link><pubDate>Tue, 12 Jul 2016 23:29:35 +0800</pubDate><guid>https://ops.m114.org/post/fix-dell-idrac-7-error-rac0218-the-maximum-number-of-user-sessions-is-reached/</guid><description>Dell R420服务器中，比较经常出现idrac无法连接，或者连接用户数超限(RAC0218错误)的问题，升级iDrac卡firmware至1.5</description></item><item><title>运维工具汇总之 性能调优，性能监控，性能测试</title><link>https://ops.m114.org/post/linux-performance-tools/</link><pubDate>Sun, 03 Jul 2016 13:39:01 +0800</pubDate><guid>https://ops.m114.org/post/linux-performance-tools/</guid><description>性能调优 性能监控 性能测试</description></item><item><title>Git常用命令备忘</title><link>https://ops.m114.org/post/git-common-command/</link><pubDate>Thu, 16 Jun 2016 12:33:10 +0800</pubDate><guid>https://ops.m114.org/post/git-common-command/</guid><description>配置 Git的设置文件为.gitconfig，它可以在用户主目录下（全局配置），也可以在项目目录下（项目配置）。 # 显示当前的Git配置 $ git config --list</description></item><item><title>Docker for Mac Beta尝鲜</title><link>https://ops.m114.org/post/docker-for-mac-beta/</link><pubDate>Fri, 20 May 2016 00:05:35 +0800</pubDate><guid>https://ops.m114.org/post/docker-for-mac-beta/</guid><description>Docker for Mac Docker for Mac 是一个原生的苹果应用程序，被安装到 /Application 目录。安装时会创建 /usr/local/bin 目录下的 docker、docker-compose、docker-mac</description></item><item><title>kernel igb 00000500 0 eth0 reset adapter</title><link>https://ops.m114.org/post/kernel-igb-00000100-0-eth0-reset-adapter/</link><pubDate>Wed, 03 Jun 2015 23:04:55 +0800</pubDate><guid>https://ops.m114.org/post/kernel-igb-00000100-0-eth0-reset-adapter/</guid><description>系统环境 CentOS 6.4 igb driver version 4.0.1-k 报错信息如下 Jun 3 13:20:05 localhost kernel: igb 0000:05:00.1: eth1: Reset adapter Jun 3 13:20:06 localhost kernel: igb 0000:05:00.0: eth0: Reset adapter Jun 3 13:20:11 localhost kernel: igb: eth1 NIC Link is Up 1000 Mbps Full Duplex, Flow Control: RX Jun 3 13:20:12 localhost kernel: igb: eth0 NIC Link is Up 1000 Mbps Full Duplex, Flow</description></item><item><title>DNSPOD API SSL证书调整(subjectAltName)引起的报错</title><link>https://ops.m114.org/post/dnspod-api-ssl-subjectaltname/</link><pubDate>Sun, 10 May 2015 23:44:43 +0800</pubDate><guid>https://ops.m114.org/post/dnspod-api-ssl-subjectaltname/</guid><description>报错信息如下： Python 2.7 (r27:82500, Jan 7 2014, 23:14:35) [GCC 4.1.2 20080704 (Red Hat 4.1.2-50)] on linux2 Type &amp;#34;help&amp;#34;, &amp;#34;copyright&amp;#34;, &amp;#34;credits&amp;#34; or &amp;#34;license&amp;#34; for more information. &amp;gt;&amp;gt;&amp;gt; import requests &amp;gt;&amp;gt;&amp;gt; r = requests.get(&amp;#34;https://dnsapi.cn&amp;#34;) Traceback (most recent call last): File &amp;#34;&amp;lt;stdin&amp;gt;&amp;#34;, line 1, in &amp;lt;module&amp;gt; File &amp;#34;/usr/local/lib/python2.7/site-packages/requests-2.0.0-py2.7.egg/requests/api.py&amp;#34;, line 55, in get return request(&amp;#39;get&amp;#39;, url, **kwargs) File &amp;#34;/usr/local/lib/python2.7/site-packages/requests-2.0.0-py2.7.egg/requests/api.py&amp;#34;, line 44, in request return session.request(method=method, url=url, **kwargs) File</description></item><item><title>俄罗斯永久冬令时的坑</title><link>https://ops.m114.org/post/russia-permanent-winter-time/</link><pubDate>Sun, 26 Apr 2015 16:59:30 +0800</pubDate><guid>https://ops.m114.org/post/russia-permanent-winter-time/</guid><description>本文更新说明 2017.03.17: 修复java时区更新方法 系统环境 OS: CentOS 6.X JDK: 6 背景 因游戏在俄罗斯运营，采用了莫斯科时间，俄罗斯宣布2014年10月26日开始永久冬</description></item><item><title>利用TsunamiUDP加速跨机房迁移</title><link>https://ops.m114.org/post/use-tsunamiudp-accelerate-migration-across-data-centers/</link><pubDate>Sun, 26 Apr 2015 16:00:00 +0800</pubDate><guid>https://ops.m114.org/post/use-tsunamiudp-accelerate-migration-across-data-centers/</guid><description>部署 yum -y install automake autoconf git clone git://github.com/rriley/tsunami-udp.git cd tsunami-udp ./recompile.sh cp server/tsunamid client/tsunami /usr/bin #或者从sf.net下载 wget http://iweb.dl.sourceforge.net/project/tsunami-udp/tsunami-udp/tsunami-v1.1-cvsbuild42/tsunami-v1.1-cvsbuild42.tar.gz tar zxf tsunami-v1.1-cvsbuild42.tar.gz cd tsunami-udp-v11-b42 ./recompile.sh cp server/tsunamid client/tsunami /usr/bin 使用 #1、防火墙调整 #服务端：开启TCP 46224(默认端</description></item><item><title>Zabbix使用Telegram发送报警</title><link>https://ops.m114.org/post/zabbix-alerts-use-telegram/</link><pubDate>Sat, 25 Apr 2015 17:16:29 +0800</pubDate><guid>https://ops.m114.org/post/zabbix-alerts-use-telegram/</guid><description>环境 CentOS 6.X x86_64 编译Telegram yum -y install lua-devel openssl-devel libconfig-devel readline-devel libevent-devel git clone --recursive https://github.com/vysheng/tg.git cd tg ./configure make mkdir /usr/local/tg cp tg-server.pub /usr/local/tg cp bin/telegram-cli /usr/local/tg zabbix报警脚本/usr/local/tg/telegra</description></item><item><title>Monitor SSL certificate expiry</title><link>https://ops.m114.org/post/monitor-ssl-certificate-expiry/</link><pubDate>Sat, 25 Apr 2015 16:31:41 +0800</pubDate><guid>https://ops.m114.org/post/monitor-ssl-certificate-expiry/</guid><description>看到网上弄了个zabbix监控SSL证书过期时间的,给咱业务也加了个此监控。 改进如下： 基于域名监控(一台服务器上有多个证书) 当前使用的she</description></item><item><title>使用Hugo搭建免费个人Blog</title><link>https://ops.m114.org/post/how-to-use-hugo/</link><pubDate>Tue, 11 Nov 2014 17:15:00 +0800</pubDate><guid>https://ops.m114.org/post/how-to-use-hugo/</guid><description>Hugo是什么 Hugo是一个工具，可以用于搭建静态站点，类似jekyll，不过Hugo是Golang写的，大家应该知道Golang有一个对部</description></item></channel></rss>